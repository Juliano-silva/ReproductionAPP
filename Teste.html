<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlist</title>
    <link rel="stylesheet" href="../static/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <input type="text" id="PlaylistName">
    <button onclick="Salvar()">Click</button>
    <div id="BodyList">
        <audio id="MusicPlaylist" controls></audio>
    </div>
    <!-- Templete -->
    <div id="Templete">
        <img id="TPImage" alt="">
        <h1 id="TP_Name"></h1>
        <div id="Conteúdo_Templete">
            <input type="checkbox" id="PPEvent">
            <label for="PPEvent">
                <i id="BtnPauseEvent" class="fas fa-pause"></i>
                <i style="display: none;" id="BtnPlayEvent" class="fas fa-play"></i>
            </label>
            <input type="checkbox" id="MuteeDismute">
            <label id="LabelControl" for="MuteeDismute">
                <i id="BtnMute" class="fas fa-volume-mute"></i>
                <i style="display: none;" id="BtnVolume" class="fas fa-volume-down"></i>
            </label>
            <button id="Menos5"><i class="fa fa-backward"></i></button>
            <button id="Recomeçar"><i class="fa fa-stop	"></i></button>
            <button id="Mais5"><i class="fa fa-forward"></i></button>
            <button id="Randomizando"><i class="fa-solid fa-shuffle"></i></button>
            <button id="Trás"><i class="fa-solid fa-arrow-left"></i></button>
            <button id="Frente" onclick="Frente()"><i class="fa-solid fa-arrow-right"></i></button>
            <button id="NormalVolume"><i class="fa fa-volume-up"></i></button>
            <button id="NormalPlayBack"><i class="fas fa-tachometer-alt"></i></button>
        </div>
        <input type="range" min="0" step="0.1" max="1" id="Volume">
        <input type="range" id="PlayBack" orient="vertical" min="0.1" step="0.25" max="10">
    </div>
</body>
<script>
    var array = []
var Diretorio = "/music/"
var Player = document.getElementById("MusicPlaylist")
function Salvar() {
    if (localStorage.Playlist) {
        array = JSON.parse(localStorage.getItem("Playlist"))
    }
    array.push({
        "Name": document.getElementById("PlaylistName").value,
        "Lista": []
    })
    localStorage.Playlist = JSON.stringify(array)
}

function RodarPlaylist() {
    var BuscarItens = localStorage.getItem("Playlist")
    for (var i = 0; i < JSON.parse(BuscarItens).length; i++) {
        var CaixaPlaylist = document.createElement('div')
        var Titulo = document.createElement("h1")
        Titulo.innerText = JSON.parse(BuscarItens)[i].Name
        console.log(JSON.parse(BuscarItens)[i]);
        CaixaPlaylist.id = "Caixa_Playlist"
        CaixaPlaylist.append(Titulo)
        document.getElementById("BodyList").append(CaixaPlaylist)
        for (var q = 0; q < JSON.parse(BuscarItens)[i].Lista.split(/,(?! )/).length; q++) {
            var PlayOne = document.createElement("div")
            var Name = document.createElement("h1")
            Name.innerText = PlayOne.id = JSON.parse(BuscarItens)[i].Lista.split(/,(?! )/)[q]
            PlayOne.className = "PlayBox"
            PlayOne.append(Name)
            CaixaPlaylist.append(PlayOne)
            // Function Playlist
            PlayOne.addEventListener("click", function () {
                MusicPlaylist.src = Diretorio + this.id
            })
        }
    }
}

document.onload = RodarPlaylist()
</script>
</html>